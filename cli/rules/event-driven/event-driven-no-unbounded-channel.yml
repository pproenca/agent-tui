id: event-driven-no-unbounded-channel
language: rust
severity: warning
message: "Use bounded channels for backpressure; avoid unbounded channels."
note: |
  Unbounded channels can grow without limit under load.
  Prefer bounded channels (e.g., channel::bounded, tokio::sync::mpsc::channel) to enforce backpressure.

  Guidance:
  - Pick a capacity based on expected burst size and acceptable latency.
  - If producers must never block, consider bounded + drop strategy or a dedicated queue with metrics.
  - If unbounded is truly required, add a local comment with the rationale and monitor memory usage.
rule:
  any:
    - pattern: channel::unbounded()
    - pattern: crossbeam_channel::unbounded()
    - pattern: tokio::sync::mpsc::unbounded_channel()
