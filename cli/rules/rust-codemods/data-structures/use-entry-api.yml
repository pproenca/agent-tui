id: ds-use-entry-api
language: rust
severity: warning
message: "Use entry API instead of contains_key() + insert() to avoid double lookup"
note: |
  Checking contains_key() then calling insert() performs two hash lookups.
  Use the entry API for a single lookup:

  Before: if !map.contains_key(&k) { map.insert(k, v); }
  After:  map.entry(k).or_insert(v);
rule:
  pattern: if !$MAP.contains_key($KEY) { $MAP.insert($$$); }
